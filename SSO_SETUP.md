# Настройка SSO для Teams App

## Что было реализовано

1. **Обновлен aad.manifest.json** с правильным Client ID: `17479755-e076-41c8-8cfb-08518cbcd835`

2. **Создан компонент LoginScreen** (`src/components/LoginScreen.tsx`) с красивым интерфейсом входа

3. **Обновлен AppProvider** для показа экрана входа перед приложением

4. **Обновлен auth.ts** для правильной работы с SSO

5. **Настроены переменные окружения** в `.localConfigs`

## Как запустить

1. Убедитесь, что у вас установлены все зависимости:
   ```bash
   npm install
   cd api && npm install
   ```

2. Запустите приложение в режиме разработки:
   ```bash
   npm run dev:teamsfx
   ```

3. При первом запуске приложения вы увидите экран входа с кнопкой "Войти с помощью учётной записи Microsoft"

4. При нажатии на кнопку откроется стандартный интерфейс Microsoft для выбора аккаунта

## Файлы аутентификации

Файлы `auth-start.html` и `auth-end.html` уже находятся в папке `public/` и настроены для работы с SSO.

## Конфигурация

- **Client ID**: `17479755-e076-41c8-8cfb-08518cbcd835`
- **Redirect URI**: `https://localhost:53000/auth-end.html`
- **Scope**: `access_as_user`

## Примечания

- Приложение будет показывать экран входа до тех пор, пока пользователь не войдет в систему
- После успешного входа пользователь увидит основное приложение
- Токены автоматически обновляются каждые 50 минут

## Режимы работы

### В Teams
- Используется полноценный SSO через Teams SDK
- Автоматическое получение токенов и информации о пользователе
- Автоматическое обновление токенов

### В браузере (вне Teams)
- Используется аутентификация через Microsoft OAuth
- Открывается всплывающее окно для входа
- Создается демонстрационный пользователь для тестирования

## Устранение проблем

Если возникает ошибка "Initialize teams sdk failed due to not running inside Teams environment":
- Это нормально при запуске в браузере
- Приложение автоматически переключится на браузерную аутентификацию
- Для полноценного SSO запускайте приложение внутри Teams
